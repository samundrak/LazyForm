Array.prototype.insert=function(t,e){this.splice(t,0,e)};var Form=function(){function Form(){var t=this;this.$validator={},this.$replaceString="$input",this.$submitCallback=void 0,this.$name=void 0,this.$inputFieldsName=[],this.getForm=function(){return t.$form},this.getRawHTML=function(){return t.$container.innerHTML},this.$callback=void 0}return Form.prototype.setFormOptions=function(t){this.$formOptions=t},Form.prototype.setInputValue=function(t,e){-1!==this.$inputFieldsName.indexOf(t)&&(document.forms[this.$name][t].value=e)},Form.prototype.getInputValue=function(t){return-1===this.$inputFieldsName.indexOf(t)?void console.warn("This key("+t+") is not available"):document.forms[this.$name][t].value},Form.prototype.getAllInputDom=function(){var t=this,e=[];return this.$inputFieldsName.forEach(function(r){e.push(document.forms[t.$name][r])}),e},Form.prototype.getInputDom=function(t){return-1===this.$inputFieldsName.indexOf(t)?void console.warn("This key("+t+") is not available"):document.forms[this.$name][t]},Form.prototype.getAllInputValue=function(){var t=this,e={};return this.$inputFieldsName.forEach(function(r){e[r]=document.forms[t.$name][r].value}),e},Form.prototype.getContainer=function(){return this.$container},Form.prototype.create=function(fields){var _this=this;if(!this.$formOptions)return void console.warn(Constant.error.noFormOptions);var form=this.buildForm();return this.placeTheForm(form),this.buildChilds(),this.attachEvents(),this.$name?document.forms[this.$name]?void(document.forms[this.$name].onsubmit=function(event){var inputValues={};for(var key in _this.$validator)inputValues[key]=_this.getInputValue(key);var isFormPassedValidation=!1;for(var key in inputValues)isFormPassedValidation=_this.validationWatcher({emitter:key,value:inputValues[key],event:event});return isFormPassedValidation?(_this.$formOptions.hasOwnProperty("attribute")&&(_this.$formOptions.attribute.hasOwnProperty("onsubmit")||_this.$formOptions.attribute.hasOwnProperty("onSubmit"))&&eval(_this.$formOptions.attribute.onsubmit||_this.$formOptions.attribute.onSubmit),!0):!1}):console.error(Constant.error.noFormName):console.error(Constant.error.noFormAttr)},Form.prototype.getValue=function(t){console.log()},Form.prototype.placeTheForm=function(t){if(this.$formOptions.hasOwnProperty("container")){var e=this.$formOptions.container;if(e.startsWith(".")){var r=document.getElementsByClassName(e.substring(1,e.length));r.length&&(this.$container=r,r[0].appendChild(t))}else if(e.startsWith("#"))this.$container=document.getElementById(e.substring(1,e.length)),this.$container.appendChild(t);else{var r=document.getElementsByTagName(e);r.length&&(this.$container=r,r[0].appendChild(t))}}},Form.prototype.createFields=function(t,e){var r,n=document.createElement(t);if(n.setAttribute("type","text"),this.$formOptions.fields.hasOwnProperty("common")){if(this.$formOptions.fields.common.attr)for(var i in this.$formOptions.fields.common.attr)n.setAttribute(i,this.$formOptions.fields.common.attr[i]);r=e.attr.hasOwnProperty("template")?e.attr.template:this.$formOptions.fields.common.hasOwnProperty("template")?this.$formOptions.fields.common.template:this.$replaceString}for(var i in e.attr)"name"===i&&this.$inputFieldsName.push(e.attr[i]),n.setAttribute(i,e.attr[i]);return{input:n,template:r}},Form.prototype.createElements=function(t,e,r){var n=document.createElement("div");return e&&(n.style.display="none",r&&n.setAttribute("id","errorLabelContainer_"+r)),t.forEach(function(t){var r=document.createElement(t.element||"div");for(var i in t.attr)r.setAttribute(i,t.attr[i]);r.innerHTML=t.value||e||"",n.appendChild(r)}),n},Form.prototype.buildChilds=function(){var t=this;if(this.$formOptions.hasOwnProperty("fields")&&this.$formOptions.fields.hasOwnProperty("fields")){var e,r=[],n=this;for(var i in this.$formOptions.fields.fields)switch(i){case"textarea":case"input":this.$formOptions.fields.fields[i].forEach(function(o){if(!Array.isArray(o.attr)){var a=document.createElement("temp"),s=t.createFields(i,o);if(o.before&&a.appendChild(t.createElements(o.before)),!s.template)return console.error(Constant.error.noTemplate);a.appendChild(s.input),t.$formOptions.fields.validationElement&&("submit"!=o.attr.type&&"Submit"!=o.attr.type?a.appendChild(t.createElements([t.$formOptions.fields.validationElement],"This Field is required",o.attr?o.attr.name:void 0)):s.input.setAttribute("name","submit")),o.after&&a.appendChild(t.createElements(o.after)),o.validation&&(n.$validator[o.attr.name]=o.validation);var m=s.template.replace(t.$replaceString,a.innerHTML);"submit"==o.attr.type||"Submit"===o.attr.type?e=m:r.push({index:o.rank||-1,data:m})}});break;case"select":this.$formOptions.fields.fields[i].forEach(function(e){var i=document.createElement("temp"),o=t.createFields("select",e);e.options.forEach(function(t){var e=document.createElement("option");for(var r in t.attr)e.setAttribute(r,t.attr[r]),e.innerHTML=t.text;o.input.appendChild(e)}),e.before&&i.appendChild(t.createElements(e.before)),e.validation&&(n.$validator[e.attr.name]=e.validation),i.appendChild(o.input),t.$formOptions.fields.validationElement&&i.appendChild(t.createElements([t.$formOptions.fields.validationElement],"This Field is required",e.attr?e.attr.name:void 0)),e.after&&i.appendChild(t.createElements(e.after));var a=o.template.replace(t.$replaceString,i.innerHTML);r.push({index:e.rank||-1,data:a})});break;case"checkbox":case"radio":this.$formOptions.fields.fields[i].forEach(function(e){var o=i;e.name&&t.$inputFieldsName.push(e.name);var a=document.createElement("temp");e.before&&a.appendChild(t.createElements(e.before)),e.fields.forEach(function(t){var r=(document.createElement("temp"),document.createElement("input"));r.setAttribute("type",o),e.name&&r.setAttribute("name",e.name||""),e["class"]&&r.setAttribute("class",e["class"]);for(var n in t)"text"!=n&&r.setAttribute(n,t[n]);if(a.appendChild(r),t.text){var i=document.createElement("span");i.innerHTML=t.text,a.appendChild(i)}else{var i=document.createElement("span");i.innerHTML=t.value,a.appendChild(i)}}),t.$formOptions.fields.validationElement&&a.appendChild(t.createElements([t.$formOptions.fields.validationElement],"This Field is required",e.attr?e.attr.name:void 0)),e.validation&&(n.$validator[e.attr.name]=e.validation),e.after&&a.appendChild(t.createElements(e.after));var s=e.template?e.template:t.$formOptions.fields.common.hasOwnProperty("template")?t.$formOptions.fields.common.template:t.$replaceString,m=s.replace(t.$replaceString,a.innerHTML);r.push({index:e.rank||-1,data:m})})}var o=Utils.sorter(r);this.$form.innerHTML="",Utils.reArrange(o).forEach(function(e){t.$form.innerHTML=t.$form.innerHTML+e.data}),this.$form.innerHTML=this.$form.innerHTML+e}},Form.prototype.buildForm=function(){var t=document.createElement("form");return void 0===this.$formOptions?console.error("Form options are not setup"):(this.$formOptions.hasOwnProperty("attribute")&&"object"==typeof this.$formOptions.attribute&&(this.$name=this.$formOptions.attribute.name||"form_"+Date.now(),this.$formOptions.attribute.name=this.$name,this.setAttributes(this.$formOptions.attribute,t)),this.$form=t,t)},Form.prototype.setAttributes=function(t,e){for(var r in t)e.setAttribute(r,t[r])},Form.prototype.attachListener=function(t){this.$inputFieldsName.forEach(function(e){return t.prototype[e]=new Object}),this.$callback=new t},Form.prototype.observer=function(t){var e=[8,37,38,39,40,18,91,32,16,20,9,27];-1===e.indexOf(t.event.keyCode)&&this.$callback.__proto__.hasOwnProperty(t.emitter)&&this.$callback.__proto__[t.emitter].hasOwnProperty(t.eventType)&&(this.validationWatcher(t),this.$callback.__proto__[t.emitter][t.eventType]({input:t.emitter,value:t.value,form:t.form,event:t.event}))},Form.prototype.validationWatcher=function(t,e,r){if(void 0===e&&(e=void 0),void 0===r&&(r=void 0),this.$validator.hasOwnProperty(t.emitter)){e||(e={},e[t.emitter]=this.$validator[t.emitter]),r||(r={},r[t.emitter]=t.value);var n=new Validator(r,e),i=document.getElementById("errorLabelContainer_"+t.emitter);return n.passes()?(i.style.display="none",i.firstChild.innerHTML="",document.forms[this.$name].submit.disabled=!1,!0):(i.style.display="block",i.firstChild.innerHTML=n.first(t.emitter),document.forms[this.$name].submit.disabled=!0,!1)}return!0},Form.prototype.attachEvents=function(){var t=this,e=["onkeyup","onkeydown","onmouseover","onmousedown","onclick","onfocus","onmouseenter","onmouseleave","onmousemove","onmousewheel"],r=this;this.$inputFieldsName.forEach(function(n){document.forms[t.$name][n].onblur=function(e){t.validationWatcher({emitter:n,value:document.forms[r.$name][n].value,event:e})},e.forEach(function(e){document.forms[t.$name][n][e]=function(t){r.observer({eventType:e,emitter:n,form:r.$name,value:document.forms[r.$name][n].value,event:t})}})})},Form}();