function sorter(t){var e={};return t.forEach(function(n,r){n.index?e.hasOwnProperty("index_"+n.index)?e["index_"+n.index].push({index:n.index,data:n.data}):(e["index_"+n.index]=new Array,e["index_"+n.index].push({index:n.index,data:n.data})):(e["index_"+t.length+1]=new Array,e["index_"+t.length+1].push({index:n.index,data:n.data}))}),e}function reArrange(t){var e=[];for(var n in t)e.push(t[n][0].index);e.sort();var r=[],i=!1;return e.forEach(function(e){-1!=e?t["index_"+e].forEach(function(t){r.push(t)}):i=!0}),i&&t["index_-1"].forEach(function(t){r.push(t)}),r}Array.prototype.insert=function(t,e){this.splice(t,0,e)};var Form=function(){function t(){var t=this;this.$replaceString="$input",this.$submitCallback=void 0,this.$name=void 0,this.$inputFieldsName=[],this.getRawHTML=function(){return t.$container.innerHTML}}return t.prototype.setFormOptions=function(t){this.$formOptions=t},t.prototype.setInputValue=function(t,e){-1!==this.$inputFieldsName.indexOf(t)&&(document.forms[this.$name][t].value=e)},t.prototype.getInputValue=function(t){return-1===this.$inputFieldsName.indexOf(t)?void console.warn("This key("+t+") is not available"):document.forms[this.$name][t].value},t.prototype.getAllInputDom=function(){var t=this,e=[];return this.$inputFieldsName.forEach(function(n){e.push(document.forms[t.$name][n])}),e},t.prototype.getInputDom=function(t){return-1===this.$inputFieldsName.indexOf(t)?void console.warn("This key("+t+") is not available"):document.forms[this.$name][t]},t.prototype.getAllInputValue=function(){var t=this,e={};return this.$inputFieldsName.forEach(function(n){e[n]=document.forms[t.$name][n].value}),e},t.prototype.getContainer=function(){return this.$container},t.prototype.create=function(t){if(!this.$formOptions)return void console.warn("Form options must be set, to set form options you can call set$formOptions method");var e=this.buildForm();this.placeTheForm(e),this.buildChilds()},t.prototype.getValue=function(t){console.log()},t.prototype.placeTheForm=function(t){if(this.$formOptions.hasOwnProperty("container")){var e=this.$formOptions.container;if(e.startsWith(".")){var n=document.getElementsByClassName(e.substring(1,e.length));n.length&&(this.$container=n,n[0].appendChild(t))}else if(e.startsWith("#"))this.$container=document.getElementById(e.substring(1,e.length)),this.$container.appendChild(t);else{var n=document.getElementsByTagName(e);n.length&&(this.$container=n,n[0].appendChild(t))}}},t.prototype.createFields=function(t,e){var n,r=document.createElement(t);if(r.setAttribute("type","text"),this.$formOptions.fields.hasOwnProperty("common")){if(this.$formOptions.fields.common.attr)for(var i in this.$formOptions.fields.common.attr)r.setAttribute(i,this.$formOptions.fields.common.attr[i]);n=e.attr.hasOwnProperty("template")?e.attr.template:this.$formOptions.fields.common.hasOwnProperty("template")?this.$formOptions.fields.common.template:this.$replaceString}for(var i in e.attr)"name"===i&&this.$inputFieldsName.push(e.attr[i]),r.setAttribute(i,e.attr[i]);return{input:r,template:n}},t.prototype.createElements=function(t){var e=document.createElement("div");return t.forEach(function(t){var n=document.createElement(t.element||"div");for(var r in t.attr)n.setAttribute(r,t.attr[r]);n.innerHTML=t.value,e.appendChild(n)}),e},t.prototype.buildChilds=function(){var t=this;if(this.$formOptions.hasOwnProperty("fields")&&this.$formOptions.fields.hasOwnProperty("fields")){var e,n=[];for(var r in this.$formOptions.fields.fields)switch(r){case"textarea":case"input":this.$formOptions.fields.fields[r].forEach(function(i){if(!Array.isArray(i.attr)){var o=document.createElement("temp"),a=t.createFields(r,i);i.before&&o.appendChild(t.createElements(i.before)),o.appendChild(a.input),i.after&&o.appendChild(t.createElements(i.after));var s=a.template.replace(t.$replaceString,o.innerHTML);"submit"==i.attr.type||"Submit"===i.attr.type?e=s:n.push({index:i.rank||-1,data:s})}});break;case"select":this.$formOptions.fields.fields[r].forEach(function(e){var r=document.createElement("temp"),i=t.createFields("select",e);e.options.forEach(function(t){var e=document.createElement("option");for(var n in t.attr)e.setAttribute(n,t.attr[n]),e.innerHTML=t.text;i.input.appendChild(e)}),e.before&&r.appendChild(t.createElements(e.before)),r.appendChild(i.input),e.after&&r.appendChild(t.createElements(e.after));var o=i.template.replace(t.$replaceString,r.innerHTML);n.push({index:e.rank||-1,data:o})});break;case"checkbox":case"radio":this.$formOptions.fields.fields[r].forEach(function(e){var i=r;e.name&&t.$inputFieldsName.push(e.name);var o=document.createElement("temp");e.before&&o.appendChild(t.createElements(e.before)),e.fields.forEach(function(t){var n=(document.createElement("temp"),document.createElement("input"));n.setAttribute("type",i),e.name&&n.setAttribute("name",e.name||""),e["class"]&&n.setAttribute("class",e["class"]);for(var r in t)"text"!=r&&n.setAttribute(r,t[r]);if(o.appendChild(n),t.text){var a=document.createElement("span");a.innerHTML=t.text,o.appendChild(a)}else{var a=document.createElement("span");a.innerHTML=t.value,o.appendChild(a)}}),e.after&&o.appendChild(t.createElements(e.after));var a=e.template?e.template:t.$formOptions.fields.common.hasOwnProperty("template")?t.$formOptions.fields.common.template:t.$replaceString,s=a.replace(t.$replaceString,o.innerHTML);n.push({index:e.rank||-1,data:s})})}var i=sorter(n);this.$form.innerHTML="",reArrange(i).forEach(function(e){t.$form.innerHTML=t.$form.innerHTML+e.data}),this.$form.innerHTML=this.$form.innerHTML+e}},t.prototype.buildForm=function(){var t=document.createElement("Form");if(void 0!==this.$formOptions)return this.$formOptions.hasOwnProperty("attribute")&&"object"==typeof this.$formOptions.attribute&&(this.setAttributes(this.$formOptions.attribute,t),this.$name=this.$formOptions.attribute.name||Date.now()),this.$form=t,t},t.prototype.setAttributes=function(t,e){for(var n in t)e.setAttribute(n,t[n])},t}();